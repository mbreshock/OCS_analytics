---
title: "survey_analysis"
author: "Michael Breshock"
date: "6/18/2021"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(googlesheets4)
```

Read in google form responses sheet: 
```{r}
survey = read_sheet("https://docs.google.com/spreadsheets/d/10OBdqdZKAsXzamg-IQvlIzyGd0cS2kF-xBAKXJ0yFl0/edit#gid=385855959")
```

removing first two empty rows and filtering for only respondents that consented
```{r}
responses = survey[-1:-2,]
consented = responses %>% rename(consent = `Do you consent to your responses being used for research purposes? Please see the description at the beginning of the survey for more information (use the back button within this survey if you wish to see it again).`) %>% rename(responder_category = `How would you describe yourself (choose best option)? Note that you can say  "wish not to say"  for the "other" category.`) %>%
  filter(consent == "Yes") 

consented = consented %>% rename(date = Timestamp)
attr(consented$date, "label") = "The date when the responder submitted the survey."
attr(consented$responder_category, "label") = 'How would you describe yourself (choose best option)? Note that you can say  "wish not to say"  for the "other" category.'
attr(consented$consent, "label") = "Do you consent to your responses being used for research purposes? Please see the description at the beginning of the survey for more information (use the back button within this survey if you wish to see it again)."


# split into 3 objects based on responder class (student,educator,self-learner)
# remove columns that are all NA
# possibly transpose - depends which looks best
```

```{r}
# splitting data table into different respondent types and removing all NA columns
student = filter(consented, responder_category == "Student - using case studies for a course or to help with a course")
student = student[,colSums(is.na(student))<nrow(student)]

educator = filter(consented, responder_category == "Educator of Data Science/Stats/Public Health/other - looking for data and education material to use in courses")
educator = educator[,colSums(is.na(educator))<nrow(educator)]

self_learner = filter(consented, (responder_category %in% c("Self-learner - interested in learning more about the skills, topics, and or concepts covered in the case studies", 
                        "Data analyst - using data science in the corporate world")))
self_learner = self_learner[,colSums(is.na(self_learner))<nrow(self_learner)]

# other = filter(consented, !(responder_category %in% c("Student - using case studies for a course or to help with a course", "Educator of Data Science/Stats/Public Health/other - looking for data and education material to use in courses", "Self-learner - interested in learning more about the skills, topics, and or concepts covered in the case studies")))
# other = other[,colSums(is.na(other))<nrow(other)]
```

use stringr to remove unneccessary info in responses
ex: change responses to just Student, Educator, Self-learner etc -> str_extract
ex: remove "interested in" from "interested in statistics etc" responses -> str_remove
case_when() also helpful (from dplyr)
see diet case study for help

look into making codebook
see slack
https://www.alexcernat.com/easy-way-to-make-a-codebook-in-r/

### changing column/variable names, saving old name (the question posed in survey) as label

student:
```{r}
studentdf = student %>% rename(feedback1 = `Please provide any additional feedback you might have....6`)
attr(studentdf$feedback1, "label") = "Please provide any additional feedback you might have....6"

studentdf = studentdf %>% rename(refer_back = `How likely are you to refer back to the case study/studies in the future?...11`)
attr(studentdf$refer_back, "label") = "How likely are you to refer back to the case study/studies in the future?...11"

studentdf = studentdf %>% rename(famil_stats = `How familiar were you with the statistical methods presented in the case study before you read it?...12`)
attr(studentdf$famil_stats, "label") = "How familiar were you with the statistical methods presented in the case study before you read it?...12"

studentdf = studentdf %>% rename(recommend = `How likely are you to recommend the case studies to others?...16`)
attr(studentdf$recommend, "label") = "How likely are you to recommend the case studies to others?...16"

studentdf = studentdf %>% rename(famil_PH = `How familiar were you with the public health topics presented in the case study before you read it?...19`)
attr(studentdf$famil_PH, "label") = "How familiar were you with the public health topics presented in the case study before you read it?...19"

studentdf = studentdf %>% rename(famil_DS = `How familiar were you with the data science topics presented in the case study before you read it?...20`)
attr(studentdf$famil_DS, "label") = "How familiar were you with the data science topics presented in the case study before you read it?...20"

studentdf = studentdf %>% rename(learned_new = `I learned something new about: (select all that apply)...21`)
attr(studentdf$learned_new, "label") = "I learned something new about: (select all that apply)...21"

studentdf = studentdf %>% rename(how_found = `How did you find our case studies?...22`)
attr(studentdf$how_found, "label") = "How did you find our case studies?...22"

studentdf = studentdf %>% rename(learning_interests = `What specifically brought you to the case studies? (check all that apply)`)
attr(studentdf$learning_interests, "label") = "What specifically brought you to the case studies? (check all that apply)"

studentdf = studentdf %>% rename(enjoyment = `How enjoyable did you find the case study/studies as a way to learn about these topics?...50`)
attr(studentdf$enjoyment, "label") = "How enjoyable did you find the case study/studies as a way to learn about these topics?...50"

studentdf = studentdf %>% rename(data_access = `Were you able to locate, access, and download the data for the case study with relative ease?`)
attr(studentdf$data_access, "label") = "Were you able to locate, access, and download the data for the case study with relative ease?"

studentdf = studentdf %>% rename(case_studies = `What case study(ies) have you looked at?  (select all that apply)...61`)
attr(studentdf$case_studies, "label") = "What case study(ies) have you looked at?  (select all that apply)...61"

studentdf = studentdf %>% rename(student_type = `What type of student would you describe yourself as?...68`)
attr(studentdf$student_type, "label") = "What type of student would you describe yourself as?...68"

studentdf = studentdf %>% rename(over18 = `Are you 18 or over? You cannot participate in this survey if you are under 18.`)
attr(studentdf$over18, "label") = "Are you 18 or over? You cannot participate in this survey if you are under 18."

studentdf = studentdf %>% rename(seen_casestudy = `If you have not seen a case study yet, select "Not yet" , otherwise select "Yes" to answer questions about a case study you have seen....74`)
attr(studentdf$seen_casestudy, "label") = 'If you have not seen a case study yet, select "Not yet" , otherwise select "Yes" to answer questions about a case study you have seen....74'

studentdf = studentdf %>% rename(feedback2 = `Please provide any feedback you might have....75`)
attr(studentdf$feedback2, "label") = 'Please provide any feedback you might have....75'

studentdf = studentdf %>% rename(famil_tidyverse = `How familiar were you with the tidyverse programming material presented in the case study before you read it?...85`)
attr(studentdf$famil_tidyverse, "label") = "How familiar were you with the tidyverse programming material presented in the case study before you read it?...85"

studentdf = studentdf %>% rename(famil_nonR = `Do you have familiarity with another programming language besides R?...86`)
attr(studentdf$famil_nonR, "label") = "Do you have familiarity with another programming language besides R?...86"

studentdf = studentdf %>% rename(famil_R = `How familiar were you with R programming before you read the case study?...87`)
attr(studentdf$famil_R, "label") = "How familiar were you with R programming before you read the case study?...87"

studentdf = studentdf %>% rename(usefulness = `How useful did you find the case study/studies?...104`)
attr(studentdf$usefulness, "label") = "How useful did you find the case study/studies?...104"
```

checking for missed questions; if no missed questions, display the data frame
```{r}
student_codebook = map_df(studentdf, function(x) attributes(x)$label) %>%
  gather(key = Code, value = Label)
if(nrow(student_codebook) == ncol(student)){
  student_codebook
} else{
  diff = ncol(student) - nrow(student_codebook)
  print(paste("Missed", diff, "column(s)!"))
  studentdf
}
```

educator:
```{r}
educatordf = educator %>% rename(future_teach = `Are you interested in using our case study materials or the data from one of our case studies to teach in the future?`)
attr(educatordf$future_teach, "label") = "Are you interested in using our case study materials or the data from one of our case studies to teach in the future?"

educatordf = educatordf %>% rename(feedback1 = `Please provide any additional feedback you might have....5`)
attr(educatordf$feedback1, "label") = "Please provide any additional feedback you might have....5"

educatordf = educatordf %>% rename(recommend = `How likely are you to recommend the case studies to others?...25`)
attr(educatordf$recommend, "label") = "How likely are you to recommend the case studies to others?...25"

educatordf = educatordf %>% rename(learning_interests = `What specifically brought you to the case studies? (select all that apply)...26`)
attr(educatordf$learning_interests, "label") = "What specifically brought you to the case studies? (select all that apply)...26"

educatordf = educatordf %>% rename(might_teach = `Please tell us how you might teach (or already taught) with one or more of our case studies. (Example: for materials for students to practice writing about the results of a data analysis)`)
attr(educatordf$might_teach, "label") = "Please tell us how you might teach (or already taught) with one or more of our case studies. (Example: for materials for students to practice writing about the results of a data analysis)"

educatordf = educatordf %>% rename(type_student_taught = `What type of students do you teach? (select all that apply)`)
attr(educatordf$type_student_taught, "label") = "What type of students do you teach? (select all that apply)"

educatordf = educatordf %>% rename(course_type = `What type of course(s) would you (or have you) used our case studies for? (check all that apply)`)
attr(educatordf$course_type, "label") = "What type of course(s) would you (or have you) used our case studies for? (check all that apply)"

educatordf = educatordf %>% rename(case_studies = `What case study(ies) have you looked at?  (select all that apply)...53`)
attr(educatordf$case_studies, "label") = "What case study(ies) have you looked at?  (select all that apply)...53"

educatordf = educatordf %>% rename(ocs_interest = `Which case study or case studies might you be interested  in using. (select all that apply)`)
attr(educatordf$ocs_interest, "label") = "Which case study or case studies might you be interested in using. (select all that apply)"

educatordf = educatordf %>% rename(over18 = `Are you 18 or over? You cannot participate in this survey if you are under 18.`)
attr(educatordf$over18, "label") = "Are you 18 or over? You cannot participate in this survey if you are under 18."

educatordf = educatordf %>% rename(feedback2 = `Please provide any additional feedback you might have....76`)
attr(educatordf$feedback2, "label") = "Please provide any additional feedback you might have....76"

educatordf = educatordf %>% rename(parts_used = `Are you interested in using just the data, part of case study, or a full case study?`)
attr(educatordf$parts_used, "label") = "Are you interested in using just the data, part of case study, or a full case study?"

educatordf = educatordf %>% rename(materials_used = `Please tell us which materials you are most interested in using (or you already used to teach). (select all that apply)`)
attr(educatordf$materials_used, "label") = "Please tell us which materials you are most interested in using (or you already used to teach). (select all that apply)"

educatordf = educatordf %>% rename(data_access1 = `Is it clear how to locate, access, and download files from a case study repository?...81`)
attr(educatordf$data_access1, "label") = "Is it clear how to locate, access, and download files from a case study repository?...81"

educatordf = educatordf %>% rename(already_taught = `Have you already used our case studies or the data from our case studies to teach?`)
attr(educatordf$already_taught, "label") = "Have you already used our case studies or the data from our case studies to teach?"

educatordf = educatordf %>% rename(ocs_taught = `Which case studies (or data from a case study) did you use? (select all that apply)`)
attr(educatordf$ocs_taught, "label") = "Which case studies (or data from a case study) did you use? (select all that apply)"

educatordf = educatordf %>% rename(courses_taught = `What type of course(s) did you use our case studies or data for? (check all that apply)`)
attr(educatordf$courses_taught, "label") = "What type of course(s) did you use our case studies or data for? (check all that apply)"

educatordf = educatordf %>% rename(data_access2 = `Was it clear how to locate, access, and download files from a case study repository?`)
attr(educatordf$data_access2, "label") = "Was it clear how to locate, access, and download files from a case study repository?"

educatordf = educatordf %>% rename(how_taught = `Please tell us how you taught with our data or case studies - Example: for a lecture about data wrangling or to have students write a report about a data analysis.`)
attr(educatordf$how_taught, "label") = "Please tell us how you taught with our data or case studies - Example: for a lecture about data wrangling or to have students write a report about a data analysis."

educatordf = educatordf %>% rename(data_save_time = `Did using our data save you time?`)
attr(educatordf$data_save_time, "label") = "Did using our data save you time?"

educatordf = educatordf %>% rename(data_save_effort = `Did using our data save you effort?`)
attr(educatordf$data_save_effort, "label") = "Did using our data save you effort?"

educatordf = educatordf %>% rename(teach_enjoyment = `Compared to how you taught similar material previously,  did you enjoy using the case studies to teach with?`)
attr(educatordf$teach_enjoyment, "label") = "Compared to how you taught similar material previously,  did you enjoy using the case studies to teach with?"

educatordf = educatordf %>% rename(student_enjoyment = `Compared to how you taught similar material previously,  how will did your students seem to enjoy  the case studies?`)
attr(educatordf$student_enjoyment, "label") = "Compared to how you taught similar material previously,  how will did your students seem to enjoy  the case studies?"

educatordf = educatordf %>% rename(future_data_use = `Do you plan to use our data again in the future?`)
attr(educatordf$future_data_use, "label") = "Do you plan to use our data again in the future?"

educatordf = educatordf %>% rename(parts_taught = `What did you use to teach?`)
attr(educatordf$parts_taught, "label") = "What did you use to teach?"

educatordf = educatordf %>% rename(modular_clarity = `Was it clear how to use just part of the case study in a modular way?`)
attr(educatordf$modular_clarity, "label") = "Was it clear how to use just part of the case study in a modular way?"

educatordf = educatordf %>% rename(helpful_sections = `Which sections were most helpful for you? (select all that apply)`)
attr(educatordf$helpful_sections, "label") = "Which sections were most helpful for you? (select all that apply)"

educatordf = educatordf %>% rename(do_different = `Is there anything you would do differently next time?`)
attr(educatordf$do_different, "label") = "Is there anything you would do differently next time?"

educatordf = educatordf %>% rename(student_comprehension = `Compared to how you taught similar material previously,  how well did students seem to learn the content that you taught using a case study?`)
attr(educatordf$student_comprehension, "label") = "Compared to how you taught similar material previously,  how well did students seem to learn the content that you taught using a case study?"

educatordf = educatordf %>% rename(future_cs_use = `Do you plan to use our case studies (not just data) in the future?`)
attr(educatordf$future_cs_use, "label") = "Do you plan to use our case studies (not just data) in the future?"

educatordf = educatordf %>% rename(data_types = `What type of data did you use? (select all that apply)`)
attr(educatordf$data_types, "label") = "What type of data did you use? (select all that apply)"

educatordf = educatordf %>% rename(teaching_difference = `How different was incorporating the case study or parts of the case study compared to how you typically teach similar material?`)
attr(educatordf$teaching_difference, "label") = "How different was incorporating the case study or parts of the case study compared to how you typically teach similar material?"

educatordf = educatordf %>% rename(cs_save_time = `Did incorporating our case study materials into your class, save you time?`)
attr(educatordf$cs_save_time, "label") = "Did incorporating our case study materials into your class, save you time?"

educatordf = educatordf %>% rename(cs_save_effort = `Did incorporating our case study materials into your class, save you effort?`)
attr(educatordf$cs_save_effort, "label") = "Did incorporating our case study materials into your class, save you effort?"

educatordf = educatordf %>% rename(learned_new = `Did you learn anything new using the case studies?`)
attr(educatordf$learned_new, "label") = "Did you learn anything new using the case studies?"

educatordf = educatordf %>% rename(teaching_new = `Did using our case studies allow you to incorporate something new into your teaching?`)
attr(educatordf$teaching_new, "label") = "Did using our case studies allow you to incorporate something new into your teaching?"

educatordf = educatordf %>% rename(biggest_benefit = `What was the biggest benefit of using the case study?`)
attr(educatordf$biggest_benefit, "label") = "What was the biggest benefit of using the case study?"

educatordf = educatordf %>% rename(difficult_aspect = `What was the most difficult aspect of using the case study?`)
attr(educatordf$difficult_aspect, "label") = "What was the most difficult aspect of using the case study?"

educatordf = educatordf %>% rename(typically_teach = `How do you typically teach similar material?`)
attr(educatordf$typically_teach, "label") = "How do you typically teach similar material?"

educatordf = educatordf %>% rename(how_different_typical = `If it was different from how you typically teach, how?`)
attr(educatordf$how_different_typical, "label") = "If it was different from how you typically teach, how?"

```

checking for missed questions; if no missed questions, display the data frame
```{r}
educator_codebook = map_df(educatordf, function(x) attributes(x)$label) %>%
  gather(key = Code, value = Label)
if(nrow(educator_codebook) == ncol(educator)){
  educator_codebook
} else{
  diff = ncol(educator) - nrow(educator_codebook)
  print(paste("Missed", diff, "column(s)!"))
  educatordf
}
```

self_learner: 
```{r}
self_learnerdf = self_learner %>% rename(learning_interests = `What specifically brought you to the case studies? (select all that apply)...31`)
attr(self_learnerdf$learning_interests, "label") = "What specifically brought you to the case studies? (select all that apply)...31"

self_learnerdf = self_learnerdf %>% rename(famil_stats = `How familiar were you with the statistical methods presented in the case study before you read it?...32`)
attr(self_learnerdf$famil_stats, "label") = "How familiar were you with the statistical methods presented in the case study before you read it?...32"

self_learnerdf = self_learnerdf %>% rename(famil_PH = `How familiar were you with the public health topics presented in the case study before you read it?...33`)
attr(self_learnerdf$famil_PH, "label") = "How familiar were you with the public health topics presented in the case study before you read it?...33"

self_learnerdf = self_learnerdf %>% rename(famil_DS = `How familiar were you with the data science topics presented in the case study before you read it?...34`)
attr(self_learnerdf$famil_DS, "label") = "How familiar were you with the data science topics presented in the case study before you read it?...34"

self_learnerdf = self_learnerdf %>% rename(usefulness = `How useful did you find the case study/studies?...36`)
attr(self_learnerdf$usefulness, "label") = "How useful did you find the case study/studies?...36"

self_learnerdf = self_learnerdf %>% rename(refer_back = `How likely are you to refer back to the case study/studies in the future?...37`)
attr(self_learnerdf$refer_back, "label") = "How likely are you to refer back to the case study/studies in the future?...37"

self_learnerdf = self_learnerdf %>% rename(recommend = `How likely are you to recommend the case studies to others?...38`)
attr(self_learnerdf$recommend, "label") = "How likely are you to recommend the case studies to others?...38"

self_learnerdf = self_learnerdf %>% rename(feedback1 = `Please provide any feedback you might have....41`)
attr(self_learnerdf$feedback1, "label") = "Please provide any feedback you might have....41"

self_learnerdf = self_learnerdf %>% rename(learned_new = `I learned something new about: (select all that apply)...43`)
attr(self_learnerdf$learned_new, "label") = "I learned something new about: (select all that apply)...43"

self_learnerdf = self_learnerdf %>% rename(enjoyment = `How enjoyable did you find the case study/studies as a way to learn about these topics?...49`)
attr(self_learnerdf$enjoyment, "label") = "How enjoyable did you find the case study/studies as a way to learn about these topics?...49"

self_learnerdf = self_learnerdf %>% rename(data_access = `Were you able to locate, access, and download files from the case study repository with relative ease?`)
attr(self_learnerdf$data_access, "label") = "Were you able to locate, access, and download files from the case study repository with relative ease?"

self_learnerdf = self_learnerdf %>% rename(case_studies = `What case study(ies) have you looked at?  (select all that apply)...62`)
attr(self_learnerdf$case_studies, "label") = "What case study(ies) have you looked at?  (select all that apply)...62"

self_learnerdf = self_learnerdf %>% rename(over18 = `Are you 18 or over? You cannot participate in this survey if you are under 18.`)
attr(self_learnerdf$over18, "label") = "Are you 18 or over? You cannot participate in this survey if you are under 18."

self_learnerdf = self_learnerdf %>% rename(seen_casestudy = `If you have not seen a case study yet, select "Not yet" , otherwise select "Yes" to answer questions about a case study you have seen....71`)
attr(self_learnerdf$seen_casestudy, "label") = 'If you have not seen a case study yet, select "Not yet" , otherwise select "Yes" to answer questions about a case study you have seen....71'

self_learnerdf = self_learnerdf %>% rename(feedback2 = `Please provide any feedback you might have....72`)
attr(self_learnerdf$feedback2, "label") = "Please provide any feedback you might have....72"

self_learnerdf = self_learnerdf %>% rename(field_of_work = `What field do you work in? (we would like to know more about who is interested in our case studies - you are not required to answer)...73`)
attr(self_learnerdf$field_of_work, "label") = "What field do you work in? (we would like to know more about who is interested in our case studies - you are not required to answer)...73"

self_learnerdf = self_learnerdf %>% rename(famil_R = `How familiar were you with R programming before you read the case study?...88`)
attr(self_learnerdf$famil_R, "label") = "How familiar were you with R programming before you read the case study?...88"

self_learnerdf = self_learnerdf %>% rename(famil_tidyverse = `How familiar were you with the tidyverse programming material presented in the case study before you read it?...89`)
attr(self_learnerdf$famil_tidyverse, "label") = "How familiar were you with the tidyverse programming material presented in the case study before you read it?...89"

self_learnerdf = self_learnerdf %>% rename(famil_nonR = `Do you have familiarity with another programming language besides R?...90`)
attr(self_learnerdf$famil_nonR, "label") = "Do you have familiarity with another programming language besides R?...90"


```

checking for missed questions; if no missed questions, display the data frame
```{r}
self_learner_codebook = map_df(self_learnerdf, function(x) attributes(x)$label) %>%
  gather(key = Code, value = Label)
if(nrow(self_learner_codebook) == ncol(self_learner)){
  self_learner_codebook
} else{
  diff = ncol(self_learner) - nrow(self_learner_codebook)
  print(paste("Missed", diff, "column(s)!"))
  self_learnerdf
}
```




**ignore:**

```{r}
surveydf = survey %>% rename(date = Timestamp)
attr(surveydf$date, "label") = "The date when the responder submitted the survey."

surveydf = surveydf %>% rename(category = `How would you describe yourself (choose best option)? Note that you can say  "wish not to say"  for the "other" category.`)
attr(surveydf$category, "label") = 'How would you describe yourself (choose best option)? Note that you can say  "wish not to say"  for the "other" category.'

surveydf = surveydf %>% rename(intended_course_use = `Do you intend to use a case study (or part of a case study) in one of your classes?`)
attr(surveydf$intended_course_use, "label") = "Do you intend to use a case study (or part of a case study) in one of your classes?"

surveydf = surveydf %>% rename(teach_future = `Are you interested in using our case study materials or the data from one of our case studies to teach in the future?`)
attr(surveydf$teach_future, "label") = "Are you interested in using our case study materials or the data from one of our case studies to teach in the future?"

surveydf = surveydf %>% rename(feedback1 = 5)
attr(surveydf$feedback1, "label") = "Please provide any additional feedback you might have....5"

surveydf = surveydf %>% rename(feedback2 = 6)
attr(surveydf$feedback2, "label") = "Please provide any additional feedback you might have....6"

surveydf = surveydf %>% rename(feedback3 = 7)
attr(surveydf$feedback3, "label") = "Please provide any feedback you might have....7"

surveydf = surveydf %>% rename(useful = `How useful did you find the case studies/data?`)
attr(surveydf$useful, "label") = "How useful did you find the case studies/data?"

surveydf = surveydf %>% rename(refer_back = 11)
attr(surveydf$refer_back, "label") = "How likely are you to refer back to the case study/studies in the future?...11"

```
